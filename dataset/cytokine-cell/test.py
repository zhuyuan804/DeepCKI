import pandas as pd
import numpy as np

# feature = pd.read_pickle("feature.pkl")


uniprot = pd.read_pickle("features.pkl")

uniprot.index = [i for i in range(uniprot.shape[0])]

print(uniprot.columns)

uniprot = uniprot[['Entry', 'Entry name', 'Protein names', 'Gene names', 'Organism',
       'Cross-reference (Pfam)', 'Sequence', 'Cross-reference (STRING)',
       'Length', 'filter_mf', 'filter_cc', 'filter_bp', 'cc_label', 'mf_label',
       'bp_label', 'CT', 'Sub_cell_loc', 'Sub_cell_loc_encoding',
       'protein-domain', 'Pro_domain_encoding', 'cytokine']]

cell_cytokine = pd.read_csv("cytokine-cell.csv")
print(cell_cytokine.shape[0])

# cell_new = ['CL_0000775', 'CL_0000738', 'CL_0000595', 'CL_0000233', 'CL_0000235', 'CL_0000084', 'CL_0000775', 'CL_0000738', 'CL_0000763', 'CL_0000129', 'CL_0000775', 'CL_0000096', 'CL_0000182', 'CL_0000775', 'CL_0000057', 'CL_0000236', 'CL_0000084', 'CL_0000542', 'CL_0000819', 'CL_0000235', 'CL_0000912', 'CL_0000623', 'CL_0000084', 'CL_0000218', 'CL_0000136', 'CL_0000084', 'CL_0000775', 'CL_0000235', 'CL_0000084', 'CL_0000576', 'CL_0000771', 'CL_0000094', 'CL_0000738', 'CL_0000451', 'CL_0000542', 'CL_0000763', 'CL_0000583', 'CL_0002092', 'CL_0000092', 'CL_0000557', 'CL_0000624', 'CL_0000066', 'CL_0000233', 'CL_0000625', 'CL_0000784', 'CL_0000556', 'CL_0000236', 'CL_0000623', 'CL_0000097', 'CL_0000910', 'CL_0000145', 'CL_0000453', 'CL_0000546', 'CL_0000767', 'CL_0000214', 'CL_0000040', 'CL_0000499', 'CL_0000912', 'CL_0000057', 'CL_0000115', 'CL_0000312', 'CL_0000129', 'CL_0000863', 'CL_0000034', 'CL_0002477', 'CL_0000084', 'CL_0000625', 'CL_0000542', 'CL_0000623', 'CL_0000738', 'CL_0000624', 'CL_0000814', 'CL_0000359', 'CL_0000115', 'CL_0000451', 'CL_0000236', 'CL_0000545', 'CL_0000910', 'CL_0000650', 'CL_0000540', 'CL_0002619', 'CL_0000182', 'CL_0000771', 'CL_0000084', 'CL_0002539', 'CL_0000738', 'CL_0000863', 'CL_0000019', 'CL_0000236', 'CL_0000182', 'CL_0000738', 'CL_0000233', 'CL_0000084', 'CL_0000037', 'CL_0000122', 'CL_0000576', 'CL_0000057', 'CL_0000545', 'CL_0000542', 'CL_0000135', 'CL_0000632', 'CL_0000595', 'CL_0000038', 'CL_0000232', 'CL_0000558', 'CL_0000765', 'CL_0000084', 'CL_0000556', 'CL_0000547', 'CL_0000235', 'CL_0000233', 'CL_0000746', 'CL_0000134', 'CL_0000115', 'CL_0000100', 'CL_0002092', 'CL_0000047', 'CL_0000775', 'CL_0000148', 'CL_0000094', 'CL_0000056', 'CL_0000542', 'CL_0000057', 'CL_0000128', 'CL_0000034', 'CL_0000236', 'CL_0000775', 'CL_0000128', 'CL_0000127', 'CL_0000576', 'CL_0000115', 'CL_0000084', 'CL_0000624', 'CL_0000738', 'CL_0000898', 'CL_0000911', 'CL_0000576', 'CL_0000235', 'CL_0000738', 'CL_0000084', 'CL_0000775', 'CL_0000136', 'CL_0000624', 'CL_0000540', 'CL_0000115', 'CL_0000113', 'CL_0000650', 'CL_0000047', 'CL_0000127', 'CL_0000037', 'CL_0000860', 'CL_0000653', 'CL_0000542', 'CL_0000057', 'CL_0002368', 'CL_0002322', 'CL_0000771', 'CL_0002629', 'CL_0000625', 'CL_0000145', 'CL_0000359', 'CL_0000581', 'CL_0000134', 'CL_0000863', 'CL_1001319', 'CL_0000100', 'CL_0000831', 'CL_0000236', 'CL_0000546', 'CL_0000135', 'CL_0000771', 'CL_0000084', 'CL_0000235', 'CL_0000540', 'CL_0000322', 'CL_0000545', 'CL_0000909', 'CL_0000236', 'CL_0000898', 'CL_0000647', 'CL_0000034', 'CL_0000653', 'CL_0000066', 'CL_0000771', 'CL_0000860', 'CL_0000738', 'CL_0000542', 'CL_0000084', 'CL_0000738', 'CL_0000792', 'CL_0000899', 'CL_0000236', 'CL_0000540', 'CL_0002563', 'CL_0000451', 'CL_0000775', 'CL_0000057', 'CL_0000233', 'CL_0000236', 'CL_0000084', 'CL_0000624', 'CL_0000576', 'CL_0000625', 'CL_0000115', 'CL_0000542', 'CL_0000771', 'CL_0000235', 'CL_0000794', 'CL_0000545', 'CL_0000623', 'CL_0000835', 'CL_0000127', 'CL_0000738', 'CL_0002619', 'CL_0000898', 'CL_0000451', 'CL_0000775', 'CL_0000084', 'CL_0000235', 'CL_0000499', 'CL_0000738', 'CL_0000233', 'CL_0000792', 'CL_0000911', 'CL_0000127', 'CL_0000092', 'CL_0000235', 'CL_0000623', 'CL_0000771', 'CL_0000542', 'CL_0000084', 'CL_0000235', 'CL_0000097', 'CL_0000084', 'CL_0000738', 'CL_0000624', 'CL_0000792', 'CL_0000893', 'CL_0000546', 'CL_0000583', 'CL_0000235', 'CL_0000771', 'CL_0000084', 'CL_0000893', 'CL_0000134', 'CL_0000792', 'CL_0000576', 'CL_0000738', 'CL_0000542', 'CL_0000235', 'CL_0000084', 'CL_0000771', 'CL_0000771', 'CL_0000738', 'CL_0000084', 'CL_0000576', 'CL_0000775', 'CL_0000034', 'CL_0000094', 'CL_0000037', 'CL_0002246', 'CL_0000096', 'CL_0000738', 'CL_0000557', 'CL_0000839', 'CL_0000084', 'CL_0000576', 'CL_0000763', 'CL_0002092', 'CL_0000542', 'CL_0000746', 'CL_0000115', 'CL_0000023', 'CL_0000540', 'CL_0002619', 'CL_0000236', 'CL_0000062', 'CL_0002608', 'CL_0000081', 'CL_0000771', 'CL_0000584', 'CL_0000100', 'CL_0000235', 'CL_0000624', 'CL_0002195', 'CL_0000581', 'CL_0000233', 'CL_0000514', 'CL_0000738', 'CL_0000771', 'CL_0000084', 'CL_0000034', 'CL_0000775', 'CL_0000235', 'CL_0000767', 'CL_0000097', 'CL_0000540', 'CL_0000218', 'CL_0000049', 'CL_0000623', 'CL_0000129', 'CL_0000540', 'CL_0000771', 'CL_0000235', 'CL_0000092', 'CL_0000576', 'CL_0000113', 'CL_0000091', 'CL_0000233', 'CL_0000763', 'CL_0000129', 'CL_0000084', 'CL_0000066', 'CL_0000057', 'CL_0000540', 'CL_0000062', 'CL_0002397', 'CL_0000384', 'CL_0002139', 'CL_0000056', 'CL_0000501', 'CL_0000232', 'CL_0000094', 'CL_0000775', 'CL_0000038', 'CL_0000581', 'CL_0000771', 'CL_0000546', 'CL_0000084', 'CL_0000235', 'CL_0000236', 'CL_0000576', 'CL_0000066', 'CL_0000738', 'CL_0000624', 'CL_0000540', 'CL_0002368', 'CL_0000793', 'CL_0000135', 'CL_0002328', 'CL_0000067', 'CL_0000232', 'CL_0000160', 'CL_0000182', 'CL_0000625', 'CL_0000890', 'CL_0000546', 'CL_0000312', 'CL_0000362', 'CL_0000771', 'CL_0000236', 'CL_0000084', 'CL_0000819', 'CL_0000624', 'CL_0000542', 'CL_0000767', 'CL_0000669', 'CL_0000611', 'CL_0000041', 'CL_0000775', 'CL_0000235', 'CL_0000576', 'CL_0000138', 'CL_0000775', 'CL_0000738', 'CL_0000084', 'CL_0000540', 'CL_0000127', 'CL_0000057', 'CL_0000499', 'CL_0000187', 'CL_0000169', 'CL_0000899', 'CL_0000650', 'CL_0000182', 'CL_0000136', 'CL_0000094', 'CL_0000584', 'CL_0000546', 'CL_0000771', 'CL_0000135', 'CL_0002608', 'CL_0000312', 'CL_0000062', 'CL_0000581', 'CL_0000097', 'CL_0000134', 'CL_0000236', 'CL_0000453', 'CL_0000556', 'CL_0000792', 'CL_0000100', 'CL_0000746', 'CL_0000233', 'CL_0000624', 'CL_0000653', 'CL_0002319', 'CL_0000911', 'CL_0000910', 'CL_0000066', 'CL_0000162', 'CL_0000137', 'CL_0000082', 'CL_0000623', 'CL_0000545', 'CL_0000214', 'CL_0000115', 'CL_0000623', 'CL_0000084', 'CL_0000625', 'CL_0000542', 'CL_0000236', 'CL_0000624', 'CL_0000792', 'CL_0000097', 'CL_0000909', 'CL_0000814', 'CL_0000824', 'CL_0000182', 'CL_0000037', 'CL_0000499', 'CL_0000115', 'CL_0002372', 'CL_0000738', 'CL_0000057', 'CL_0002563', 'CL_0000793', 'CL_0000129', 'CL_0000625', 'CL_0000084', 'CL_0000236', 'CL_0000899', 'CL_0000786', 'CL_0000623', 'CL_0000542', 'CL_0000624', 'CL_0000738', 'CL_0000814', 'CL_0000844', 'CL_0000545', 'CL_0000792', 'CL_0002038', 'CL_0000057', 'CL_0000775', 'CL_0000145', 'CL_0000824', 'CL_0000066', 'CL_0000182', 'CL_0000312', 'CL_0000545', 'CL_0000084', 'CL_0000738', 'CL_0001042', 'CL_0002322', 'CL_0000775', 'CL_0000092', 'CL_0000771', 'CL_0000236', 'CL_0000160', 'CL_0000113', 'CL_0000307', 'CL_0002586', 'CL_0000037', 'CL_0000236', 'CL_0000084', 'CL_0000546', 'CL_0000624', 'CL_0000771', 'CL_0000542', 'CL_0000235', 'CL_0000545', 'CL_0000576', 'CL_0000767', 'CL_0000097', 'CL_0000057', 'CL_0000775', 'CL_0000625', 'CL_0000792', 'CL_0000129', 'CL_0000037', 'CL_0000312', 'CL_0000898', 'CL_0000893', 'CL_0000647', 'CL_0000066', 'CL_0000092', 'CL_0000160', 'CL_0000540', 'CL_0000844', 'CL_0000890', 'CL_0000492', 'CL_0000557', 'CL_0000451', 'CL_0000115', 'CL_0000912', 'CL_0000192', 'CL_0000182', 'CL_0000556', 'CL_0000646', 'CL_0000738', 'CL_0000902', 'CL_0000499', 'CL_0000583', 'CL_0000625', 'CL_0000235', 'CL_0000624', 'CL_0000899', 'CL_0000546', 'CL_0000115', 'CL_0000771', 'CL_0000066', 'CL_0000899', 'CL_0000545', 'CL_0000084', 'CL_0000545', 'CL_0000899', 'CL_0000792', 'CL_0000746', 'CL_0000236', 'CL_0000235', 'CL_0000909', 'CL_0000898', 'CL_0000901', 'CL_0000623', 'CL_0000771', 'CL_0000451', 'CL_0000037', 'CL_0000912', 'CL_0000092', 'CL_0000625', 'CL_0000624', 'CL_0000785', 'CL_0000233', 'CL_0000062', 'CL_0000738', 'CL_0000624', 'CL_0000084', 'CL_0000623', 'CL_0000545', 'CL_0000738', 'CL_0000235', 'CL_0000542', 'CL_0000115', 'CL_0000576', 'CL_0000746', 'CL_0000775', 'CL_0000540', 'CL_0000624', 'CL_0000625', 'CL_0000622', 'CL_0000771', 'CL_0000138', 'CL_0000125', 'CL_0000091', 'CL_0000236', 'CL_0000793', 'CL_0000232', 'CL_0000312', 'CL_0000023', 'CL_0000182', 'CL_0000057', 'CL_0000233', 'CL_0000066', 'CL_0000235', 'CL_0000128', 'CL_0002092', 'CL_0000138', 'CL_0000499', 'CL_0000097', 'CL_0000236', 'CL_0000775', 'CL_0000084', 'CL_0000542', 'CL_0000235', 'CL_0000624', 'CL_0000160', 'CL_0002368', 'CL_0000792', 'CL_0000738', 'CL_0000545', 'CL_0000771', 'CL_0000136', 'CL_0000125', 'CL_0000082', 'CL_0000148', 'CL_0000236', 'CL_0000763', 'CL_0000546', 'CL_0000084', 'CL_0000235', 'CL_0000576', 'CL_0000127', 'CL_0000624', 'CL_0000057', 'CL_0000623', 'CL_0000129', 'CL_0000775', 'CL_0000056', 'CL_0000903', 'CL_0002629', 'CL_0000115', 'CL_0000125', 'CL_0000542', 'CL_0000084', 'CL_0000235', 'CL_0000625', 'CL_0000624', 'CL_0000576', 'CL_0000545', 'CL_0000542', 'CL_0000623', 'CL_0000738', 'CL_0000910', 'CL_0000236', 'CL_0000129', 'CL_0000115', 'CL_0000911', 'CL_0000312', 'CL_0000771', 'CL_0000546', 'CL_0000128', 'CL_0000182', 'CL_0000792', 'CL_0000113', 'CL_0000066', 'CL_0000057', 'CL_0000127', 'CL_0000451', 'CL_0000540', 'CL_0000794', 'CL_0000583', 'CL_0000034', 'CL_0000096', 'CL_0000584', 'CL_0000134', 'CL_0000912', 'CL_0000091', 'CL_0000097', 'CL_0000775', 'CL_0000232', 'CL_0000898', 'CL_0002368', 'CL_0000169', 'CL_0000581', 'CL_0000813', 'CL_0000899', 'CL_0000893', 'CL_0000092', 'CL_0000145', 'CL_0000824', 'CL_0000037', 'CL_0000647', 'CL_0002343', 'CL_0000038', 'CL_0000798', 'CL_0000192', 'CL_0000138', 'CL_0000556', 'CL_0002139', 'CL_0000763', 'CL_0000362', 'CL_0000499', 'CL_0000136', 'CL_0000094', 'CL_0000700', 'CL_0000233', 'CL_0000453', 'CL_1001319', 'CL_1001567', 'CL_0000586', 'CL_0002322', 'CL_0000890', 'CL_0002198', 'CL_0000811', 'CL_0000057', 'CL_0000084', 'CL_0000312', 'CL_0000115', 'CL_0000235', 'CL_0000092', 'CL_0000236', 'CL_0002139', 'CL_0000233', 'CL_0000775', 'CL_0000700', 'CL_0000576', 'CL_0000138', 'CL_0002483', 'CL_0000738', 'CL_0002334', 'CL_0000127', 'CL_0000066', 'CL_0000115', 'CL_0000148', 'CL_0000540', 'CL_0000738', 'CL_0000187', 'CL_0000514', 'CL_0000576', 'CL_0000775', 'CL_0002139', 'CL_1001611', 'CL_0000134', 'CL_0000057', 'CL_0000650', 'CL_0000092', 'CL_0000115', 'CL_0000540', 'CL_0000062', 'CL_0000034', 'CL_0000057', 'CL_0000192', 'CL_0000125', 'CL_0000134', 'CL_0000138', 'CL_0000148', 'CL_0000233', 'CL_0002544', 'CL_0000056', 'CL_0002139', 'CL_0002619', 'CL_0002322', 'CL_0000738', 'CL_0000542', 'CL_0000066', 'CL_0000100', 'CL_0000061', 'CL_0000127', 'CL_0002138', 'CL_0000048', 'CL_0000499', 'CL_0000625', 'CL_0002334', 'CL_0000081', 'CL_0000235', 'CL_0000060', 'CL_0000218', 'CL_1001607', 'CL_0000214', 'CL_0000351', 'CL_0002418', 'CL_0002319', 'CL_0000700', 'CL_0000514', 'CL_0000501', 'CL_0000312', 'CL_0000137', 'CL_0000855', 'CL_0002248', 'CL_0002453', 'CL_0000338', 'CL_0000586', 'CL_0002620', 'CL_0002311', 'CL_0000746', 'CL_0000216', 'CL_0000128', 'CL_0000261', 'CL_0000306', 'CL_0000540', 'CL_0000057', 'CL_0000115', 'CL_0000561', 'CL_0000037', 'CL_0000127', 'CL_0000746', 'CL_1000300', 'CL_0000312', 'CL_0000084', 'CL_0000097', 'CL_0000312', 'CL_0000235', 'CL_0000084', 'CL_0000546', 'CL_0000236', 'CL_0000771', 'CL_0000097', 'CL_0000624', 'CL_0000819', 'CL_0000917', 'CL_0000160', 'CL_0000233', 'CL_0000556', 'CL_0000034', 'CL_0000540', 'CL_0000746', 'CL_0000050', 'CL_0000081', 'CL_0000037', 'CL_0000837', 'CL_0000786', 'CL_0000092', 'CL_0000137', 'CL_0000775', 'CL_0000084', 'CL_0000625', 'CL_0000145', 'CL_0000236', 'CL_0000792', 'CL_0000624', 'CL_0000763', 'CL_0000235', 'CL_0000542', 'CL_0000092', 'CL_0000813', 'CL_0000775', 'CL_0000738', 'CL_0000235', 'CL_0000576', 'CL_0000775', 'CL_0000084', 'CL_0000115', 'CL_0000738', 'CL_0000182', 'CL_0000542', 'CL_0000136', 'CL_0000236', 'CL_0000540', 'CL_0000057', 'CL_0000066', 'CL_0000092', 'CL_0000312', 'CL_0000625', 'CL_0000623', 'CL_0000097', 'CL_0000062', 'CL_0000771', 'CL_0000138', 'CL_0000127', 'CL_0000214', 'CL_0000129', 'CL_0000232', 'CL_0000056', 'CL_0000746', 'CL_0000893', 'CL_0000351', 'CL_0000792', 'CL_0000798', 'CL_0000037', 'CL_0000499', 'CL_0000134', 'CL_0002139', 'CL_0002368', 'CL_0000581', 'CL_0000451', 'CL_0000624', 'CL_0000453', 'CL_0000019', 'CL_0000557', 'CL_0000545', 'CL_0000169', 'CL_0000899', 'CL_0000911', 'CL_0000319', 'CL_0000034', 'CL_0000583', 'CL_0000682', 'CL_0000934', 'CL_0000121', 'CL_0000763', 'CL_0000094', 'CL_0000650', 'CL_0000192', 'CL_0000125', 'CL_0000374', 'CL_0000091', 'CL_0000128', 'CL_0000113', 'CL_0002629', 'CL_0000082', 'CL_0002372', 'CL_0000449', 'CL_0000700', 'CL_0000160', 'CL_0000782', 'CL_0000815', 'CL_0002399', 'CL_0000218', 'CL_0002608', 'CL_1001607', 'CL_0000187', 'CL_0002319', 'CL_0000898', 'CL_0000546', 'CL_1000497', 'CL_0002619', 'CL_0002521', 'CL_0000510', 'CL_0000096', 'CL_0000362', 'CL_0000216', 'CL_0002334', 'CL_0000595', 'CL_0000871', 'CL_0002544', 'CL_0000084', 'CL_0000545', 'CL_0000625', 'CL_0000115', 'CL_0000236', 'CL_0000911', 'CL_0000084', 'CL_0000084', 'CL_0000236', 'CL_0000542', 'CL_0000499', 'CL_0000442', 'CL_0000786', 'CL_0000623', 'CL_0002365', 'CL_0000084', 'CL_0000546', 'CL_0000625', 'CL_0000624', 'CL_0000792', 'CL_0000771', 'CL_0000097', 'CL_0000034', 'CL_0000037', 'CL_0000148', 'CL_0002092', 'CL_0000586', 'CL_0000312', 'CL_0000501', 'CL_0000047', 'CL_0002322', 'CL_0000541', 'CL_0000034', 'CL_0000037', 'CL_0000084', 'CL_0000738', 'CL_0000540', 'CL_0000115', 'CL_0000775', 'CL_0000134', 'CL_0002619', 'CL_0000624', 'CL_0000099', 'CL_0000120', 'CL_0000576', 'CL_0000233', 'CL_0000129', 'CL_0000542', 'CL_0000792', 'CL_0000135', 'CL_0000047', 'CL_0000236', 'CL_0000062', 'CL_0000066', 'CL_0000556', 'CL_0000092', 'CL_0000817', 'CL_0000097', 'CL_1000413', 'CL_0000138', 'CL_0000057', 'CL_0000499', 'CL_0000128', 'CL_0000235', 'CL_0000784', 'CL_0000653', 'CL_0000056', 'CL_0000338', 'CL_0000138', 'CL_0000134', 'CL_0000057', 'CL_0000236', 'CL_0000084', 'CL_0000788', 'CL_0000843', 'CL_0000899', 'CL_0000775', 'CL_0000136', 'CL_0000775', 'CL_0000738', 'CL_0000037', 'CL_0000232', 'CL_0000182', 'CL_0002619', 'CL_0000056', 'CL_0000115', 'CL_0000235', 'CL_0000019', 'CL_0000576', 'CL_0000115', 'CL_0000192', 'CL_0000127', 'CL_0002224', 'CL_0000057', 'CL_0000128', 'CL_0000669', 'CL_1000742', 'CL_0000057', 'CL_0000540', 'CL_0000499', 'CL_0000233', 'CL_0000115', 'CL_0000145', 'CL_0000576', 'CL_0000037', 'CL_0000129', 'CL_0000556', 'CL_0000738', 'CL_0000232', 'CL_0000235', 'CL_0000738', 'CL_0000235', 'CL_0000129', 'CL_0002319', 'CL_0000623', 'CL_0002322', 'CL_0000540', 'CL_0000746', 'CL_0000034', 'CL_0000056', 'CL_0000128', 'CL_0000100', 'CL_0000121', 'CL_0000127', 'CL_0000625', 'CL_0000084', 'CL_0000738', 'CL_0000540', 'CL_0000235', 'CL_0000129', 'CL_0000623', 'CL_0000863', 'CL_0000771', 'CL_0000576', 'CL_0000084', 'CL_0002139', 'CL_0000542', 'CL_0000127', 'CL_0000057', 'CL_0000233', 'CL_0000084', 'CL_0000312', 'CL_0000062', 'CL_0000138', 'CL_0000624', 'CL_0000792', 'CL_0000235', 'CL_0000097', 'CL_0000499', 'CL_0000115', 'CL_0000134', 'CL_0000066', 'CL_0000540', 'CL_0000192', 'CL_0000653', 'CL_0000775', 'CL_0000060', 'CL_0000182', 'CL_0000034', 'CL_0000738', 'CL_0000576', 'CL_0000082', 'CL_0002328', 'CL_0000650', 'CL_0000623', 'CL_0000625', 'CL_0002327', 'CL_0000127', 'CL_0000077', 'CL_0000059', 'CL_1001319', 'CL_0000135', 'CL_0000746', 'CL_0002139', 'CL_0001035', 'CL_0000556', 'CL_0000542', 'CL_0002363', 'CL_0002231', 'CL_0000056', 'CL_0000646', 'CL_0000169', 'CL_0000037', 'CL_0000669', 'CL_0002334', 'CL_0002621', 'CL_0002150', 'CL_0000359', 'CL_0002148', 'CL_0000613', 'CL_0000187', 'CL_0000129', 'CL_0000322', 'CL_0000122', 'CL_0000136', 'CL_0002548', 'CL_0000767', 'CL_0000023', 'CL_0002368', 'CL_0000545', 'CL_0000148', 'CL_0000236', 'CL_0002063', 'CL_0000092', 'CL_0000178', 'CL_1000497', 'CL_1000490', 'CL_0002629', 'CL_0000622', 'CL_0000182', 'CL_0000540', 'CL_0000312', 'CL_0000135', 'CL_0000115', 'CL_0000647', 'CL_0000623', 'CL_0000235', 'CL_0000066', 'CL_0000023', 'CL_0000501', 'CL_0000138', 'CL_0000115', 'CL_0000218', 'CL_0000540', 'CL_0000746', 'CL_0000128', 'CL_0000129', 'CL_0002322', 'CL_0000187', 'CL_0000374', 'CL_0000353', 'CL_0000558', 'CL_0000137', 'CL_0000235', 'CL_0000101', 'CL_0000235', 'CL_0000062', 'CL_0000092', 'CL_0000084', 'CL_0000236', 'CL_0000653', 'CL_0000134', 'CL_0000138', 'CL_0000624', 'CL_0000233', 'CL_0000192', 'CL_0000057', 'CL_0000061', 'CL_0000066', 'CL_0000576', 'CL_0000738', 'CL_0000235', 'CL_0002320', 'CL_0000115', 'CL_0000763', 'CL_0000235', 'CL_0000129', 'CL_0000084', 'CL_0000235', 'CL_0000236', 'CL_0000576', 'CL_0000545', 'CL_0000624', 'CL_0000775', 'CL_0000792', 'CL_0000542', 'CL_0000738', 'CL_0000546', 'CL_0000625', 'CL_0000815', 'CL_0000969', 'CL_0000911', 'CL_0000451', 'CL_0000771', 'CL_0000540', 'CL_0000901', 'CL_0000819', 'CL_0000097', 'CL_0000129', 'CL_0000312', 'CL_0000890', 'CL_0000037', 'CL_0000145', 'CL_0000232', 'CL_0000233', 'CL_0000066', 'CL_0000786', 'CL_0000910', 'CL_0000794', 'CL_0000091', 'CL_0000746', 'CL_0000893', 'CL_0000903', 'CL_0000115', 'CL_0000785', 'CL_0000182', 'CL_0000125', 'CL_0000057', 'CL_0000899', 'CL_0000138', 'CL_0000898', 'CL_0002322', 'CL_0000127', 'CL_0000814', 'CL_0000092', 'CL_0000148', 'CL_0000084', 'CL_0000451', 'CL_0000235', 'CL_0000813', 'CL_0000775', 'CL_0000545', 'CL_0000775', 'CL_0000084', 'CL_0000738', 'CL_0000115', 'CL_0000576', 'CL_0000312', 'CL_0000540', 'CL_0000094', 'CL_0000096', 'CL_0002328', 'CL_0002368', 'CL_0000232', 'CL_0000066', 'CL_0000097', 'CL_0000236', 'CL_0000235', 'CL_0000136', 'CL_0000767', 'CL_0000542', 'CL_0000057', 'CL_0000056', 'CL_0000499', 'CL_0002619', 'CL_0000034', 'CL_0002138', 'CL_0000793', 'CL_0000235', 'CL_0000084', 'CL_0000236', 'CL_0000817', 'CL_0000624', 'CL_0000542', 'CL_0000893', 'CL_0000792', 'CL_0000625', 'CL_0000898', 'CL_0002419', 'CL_0000623', 'CL_0000738', 'CL_0000813', 'CL_0000909', 'CL_0000826', 'CL_0000798', 'CL_0000499', 'CL_0000034', 'CL_0000540', 'CL_0000023', 'CL_0000808', 'CL_0000815', 'CL_0000809', 'CL_0002364', 'CL_0000793', 'CL_0000814', 'CL_0002404', 'CL_0000059', 'CL_0002563', 'CL_0002053', 'CL_0000092', 'CL_0000312', 'CL_0000546', 'CL_0000767', 'CL_0000233', 'CL_0000097', 'CL_0000034', 'CL_0000037', 'CL_0002092', 'CL_0000771', 'CL_0000115', 'CL_0000623', 'CL_0000084', 'CL_0000556', 'CL_0000546', 'CL_0000038', 'CL_0000092', 'CL_0000738', 'CL_0000792', 'CL_0000557', 'CL_0000775', 'CL_0000049', 'CL_0000236', 'CL_0000451', 'CL_0000235', 'CL_0000624', 'CL_0000081', 'CL_0000134', 'CL_0000623', 'CL_0000084', 'CL_0000115', 'CL_0000145', 'CL_0000312', 'CL_0000775', 'CL_0000771', 'CL_0000775', 'CL_0000546', 'CL_0000792', 'CL_0000235', 'CL_0000583', 'CL_0000097', 'CL_0000912', 'CL_0000084', 'CL_0000767', 'CL_0000092', 'CL_0002089', 'CL_0000160', 'CL_0000625', 'CL_0000115', 'CL_0000135', 'CL_0000623', 'CL_0000738', 'CL_0000542', 'CL_0000148', 'CL_0000775', 'CL_0000235', 'CL_0000738', 'CL_0000624', 'CL_0000084', 'CL_0000899', 'CL_0000682', 'CL_0000182', 'CL_0000576', 'CL_0000545', 'CL_0000096', 'CL_0000540', 'CL_0000084', 'CL_0000542', 'CL_0000792', 'CL_0000624', 'CL_0000623', 'CL_0000236', 'CL_0000625', 'CL_0000824', 'CL_0000893', 'CL_0000815', 'CL_0000738', 'CL_0000910', 'CL_0000057', 'CL_0000545', 'CL_0000235', 'CL_0000576', 'CL_0000911', 'CL_0000546', 'CL_0000902', 'CL_0000023', 'CL_0000794', 'CL_0000814', 'CL_0000912', 'CL_0002404', 'CL_0000232', 'CL_0000771', 'CL_0000492', 'CL_0000451', 'CL_0000034', 'CL_0000233', 'CL_0000775', 'CL_0000115', 'CL_0000813', 'CL_0002092', 'CL_0002489', 'CL_0000899', 'CL_0000897', 'CL_0000798', 'CL_0000613', 'CL_0000598', 'CL_0000084', 'CL_0000236', 'CL_0000738', 'CL_0000182', 'CL_0000233', 'CL_0000235', 'CL_0000057', 'CL_0000576', 'CL_0000540', 'CL_0000775', 'CL_0000092', 'CL_0000542', 'CL_0000786', 'CL_0000792', 'CL_0000232', 'CL_0000136', 'CL_0000115', 'CL_0000312', 'CL_0000019', 'CL_0000899', 'CL_0000062', 'CL_0000746', 'CL_0000623', 'CL_0000624', 'CL_0000763', 'CL_0000023', 'CL_0000034', 'CL_0000893', 'CL_0000066', 'CL_0000557', 'CL_0000097', 'CL_0000037', 'CL_0002327', 'CL_0000138', 'CL_0000980', 'CL_0000100', 'CL_0000815', 'CL_0000134', 'CL_1000488', 'CL_0000101', 'CL_0000545', 'CL_0000653', 'CL_0000145', 'CL_0000499', 'CL_0000584', 'CL_0000129', 'CL_0000556', 'CL_0000771', 'CL_0000625', 'CL_0000514', 'CL_0000128', 'CL_0000650', 'CL_0002563', 'CL_0002248', 'CL_0002363', 'CL_0000148', 'CL_0000091', 'CL_0009004', 'CL_0000912', 'CL_0000137', 'CL_0000902', 'CL_0000127', 'CL_0000187', 'CL_0000819', 'CL_0000192', 'CL_0000546', 'CL_0001042', 'CL_0002619', 'CL_0002092', 'CL_0002319', 'CL_0000056', 'CL_0000911', 'CL_0000096', 'CL_1001319', 'CL_0000182', 'CL_0000540']
#
# cell_cytokine = cell_cytokine[cell_cytokine["cell"].isin(cell_new)]
# print(cell_cytokine.shape[0])

cytokine = cell_cytokine["cytokine"].values.tolist()

cell = cell_cytokine["cell"].values.tolist()

cell_cytokine_dict = {}
for i in range(cell_cytokine.shape[0]):
    cell_cytokine_dict.setdefault(cytokine[i],[]).append(cell[i])

un_cytokine = uniprot["cytokine"].values.tolist()

new_dict = {}
for i in un_cytokine:
    new_dict[i] = cell_cytokine_dict[i]

cells = [v for k,v in new_dict.items()]

uniprot["Cell"] = cells


items = [item for sublist in uniprot['Cell'] for item in sublist]
unique_elements, counts_elements = np.unique(items, return_counts=True)


def write_cell_list(ontology, ll):
    filename =  ontology + "_list.txt"
    with open(filename, 'w') as f:
        for x in ll:
            f.write(x + '\n')

# ENCODING CELL
items = [item for sublist in uniprot['Cell'] for item in sublist]

print(items)

unique_elements, counts_elements = np.unique(items, return_counts=True)
items = unique_elements
print("writing cell term list...")
write_cell_list('cell', unique_elements)
pro_mapping = dict(zip(list(items), range(len(items))))
pro_encoding = [[0] * len(items) for i in range(len(uniprot))]


for i, row in uniprot.iterrows():
    for fam in row['Cell']:
        if fam in pro_mapping:
            pro_encoding[i][pro_mapping[fam]] = 1

uniprot['cell_encoding1'] = pro_encoding

#### wirte files
print("write files...")
uniprot.to_pickle("features.pkl")
# uniprot[['Entry', 'entrez-gene-id', 'Gene names', 'Cross-reference (STRING)']].to_csv(
#     os.path.join(args.data_path, args.species, "gene_list.csv"),

#
#     features_new.to_pickle("features.pkl")
#
#
